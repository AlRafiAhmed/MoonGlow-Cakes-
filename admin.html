<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cake Delights - Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        .order-card {
            transition: all 0.3s ease;
        }
        .order-card:hover {
            transform: translateY(-2px);
        }
        .mobile-menu {
            display: none;
        }
        @media (max-width: 768px) {
            .mobile-menu {
                display: block;
            }
            .desktop-menu {
                display: none;
            }
            .mobile-menu.active {
                display: block;
            }
        }
        .login-card {
            background: linear-gradient(135deg, #fff8f8 0%, #fff 100%);
            box-shadow: 0 10px 25px rgba(240, 112, 170, 0.2);
            transition: all 0.5s ease;
        }
        .login-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(240, 112, 170, 0.3);
        }
        .input-field {
            transition: all 0.3s ease;
            border: 2px solid transparent;
            background-color: #fff5f8;
        }
        .input-field:focus {
            border-color: #ec4899;
            box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.2);
            background-color: white;
        }
        .login-btn {
            background: linear-gradient(135deg, #ec4899 0%, #d53f8c 100%);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(236, 72, 153, 0.4);
        }
        .login-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        .login-btn:hover::after {
            animation: ripple 1s ease-out;
        }
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }
        .cake-icon {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        .admin-profile-card {
            background: linear-gradient(135deg, #fff8f8 0%, #fff 100%);
            box-shadow: 0 10px 25px rgba(240, 112, 170, 0.2);
            transition: all 0.3s ease;
        }
        .admin-profile-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(240, 112, 170, 0.3);
        }
        .admin-avatar {
            border: 3px solid #fff;
            box-shadow: 0 5px 15px rgba(236, 72, 153, 0.3);
        }
        
        /* Tab Styles */
        .tab-button {
            position: relative;
            padding: 16px 24px;
            border-radius: 12px;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px solid transparent;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, #fff 0%, #f1f5f9 100%);
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #ec4899 0%, #d53f8c 100%);
            color: white;
            border-color: #be185d;
            box-shadow: 0 8px 20px rgba(236, 72, 153, 0.3);
            transform: translateY(-3px);
        }
        
        .tab-button.active:hover {
            background: linear-gradient(135deg, #d53f8c 0%, #be185d 100%);
        }
        
        .tab-icon {
            transition: all 0.3s ease;
        }
        
        .tab-button.active .tab-icon {
            transform: scale(1.1);
        }
        
        /* Section Styles */
        .section-card {
            background: linear-gradient(135deg, #fff 0%, #f8fafc 100%);
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(236, 72, 153, 0.1);
            transition: all 0.3s ease;
        }
        
        .section-card:hover {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }
        
        .section-header {
            background: linear-gradient(135deg, #ec4899 0%, #d53f8c 100%);
            color: white;
            padding: 20px 24px;
            border-radius: 16px 16px 0 0;
            border-bottom: 3px solid #be185d;
        }
        
        .section-content {
            padding: 24px;
        }
        
        /* Animation for section transitions */
        .section-enter {
            animation: slideInUp 0.5s ease-out;
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* New Navigation Styles */
        .nav-link {
            position: relative;
            font-size: 1.25rem;
            font-weight: 600;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
            border-radius: 0.5rem;
        }
        .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 50%;
            background-color: white;
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        .nav-link:hover::after {
            width: 80%;
        }
        .nav-link.active {
            background-color: rgba(255, 255, 255, 0.2);
        }
        .nav-link.active::after {
            width: 80%;
        }
        .nav-container {
            background: linear-gradient(135deg, #ec4899 0%, #be185d 100%);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .brand-name {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(to right, #ffffff, #f3f4f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        .mobile-nav-link {
            font-size: 1.25rem;
            font-weight: 600;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
            border-radius: 0.5rem;
            display: block;
            text-align: center;
        }
        .mobile-nav-link:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        /* Success Popup Styles */
        .success-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #fff 0%, #f8fafc 100%);
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            border: 2px solid #10b981;
            z-index: 1000;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        
        .popup-header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 20px 24px;
            border-radius: 16px 16px 0 0;
            border-bottom: 3px solid #047857;
        }
        
        .popup-content {
            padding: 24px;
        }
        
        .popup-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
        }

        /* Edit Mode Styles */
        .edit-mode {
            background: linear-gradient(135deg, #fef3c7 0%, #fbbf24 100%);
            border: 2px solid #f59e0b;
        }
        
        .edit-indicator {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cancel-edit-btn {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .cancel-edit-btn:hover {
            background: linear-gradient(135deg, #4b5563 0%, #374151 100%);
            transform: translateY(-1px);
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Navigation -->
    <nav class="nav-container text-white p-4">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="brand-name">MoonGlow Cakes</h1>
            <!-- Mobile Menu Button -->
            <button id="mobileMenuBtn" class="mobile-menu md:hidden p-2 rounded-lg hover:bg-pink-700 transition-colors duration-300">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
            <!-- Desktop Menu -->
            <div class="desktop-menu space-x-6">
                <a href="index.html" class="nav-link">Home</a>
                <a href="menu.html" class="nav-link">Menu</a>
                <a href="admin.html" class="nav-link active">Admin</a>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="mobile-menu hidden md:hidden mt-4">
            <div class="flex flex-col space-y-2">
                <a href="index.html" class="mobile-nav-link">Home</a>
                <a href="menu.html" class="mobile-nav-link">Menu</a>
                <a href="admin.html" class="mobile-nav-link">Admin</a>
            </div>
        </div>
    </nav>

    <!-- Success Popup -->
    <div id="successPopup" class="hidden">
        <div class="popup-overlay"></div>
        <div class="success-popup animate__animated animate__zoomIn">
            <div class="popup-header">
                <div class="flex items-center space-x-3">
                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                    <h3 class="text-2xl font-bold">Cake Added Successfully!</h3>
                </div>
            </div>
            <div class="popup-content">
                <div class="text-center mb-4">
                    <img id="popupCakeImage" src="" alt="Cake Image" class="popup-image mx-auto mb-4">
                </div>
                <div class="space-y-3">
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <span class="font-semibold text-gray-700">Cake Name:</span>
                        <span id="popupCakeName" class="ml-2 text-gray-900"></span>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <span class="font-semibold text-gray-700">Description:</span>
                        <p id="popupCakeDescription" class="mt-1 text-gray-900"></p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <span class="font-semibold text-gray-700">Price per Pound:</span>
                        <span id="popupCakePrice" class="ml-2 text-gray-900 font-bold text-lg text-green-600"></span>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <span class="font-semibold text-gray-700">Date Added:</span>
                        <span id="popupDateAdded" class="ml-2 text-gray-900"></span>
                    </div>
                </div>
                <div class="mt-6 text-center">
                    <div class="inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-full">
                        <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span class="font-semibold">Successfully added to menu!</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div class="container mx-auto py-6 md:py-12 px-4">
        <!-- Login Section -->
        <div id="loginSection" class="max-w-md mx-auto login-card rounded-2xl overflow-hidden animate__animated animate__fadeIn">
            <div class="bg-gradient-to-r from-pink-500 to-pink-600 p-6 text-white text-center">
                <div class="flex justify-center mb-3">
                    <svg class="w-12 h-12 cake-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 2a1 1 0 00-1 1v1a1 1 0 002 0V3a1 1 0 00-1-1zM4 4h3a3 3 0 006 0h3a2 2 0 012 2v9a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2zm2.5 7a1.5 1.5 0 100-3 1.5 1.5 0 000 3zm2.45 4a2.5 2.5 0 10-4.9 0h4.9zM12 9a1 1 0 100 2h3a1 1 0 100-2h-3zm-1 4a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z"></path>
                    </svg>
                </div>
                <h2 class="text-3xl font-bold">Admin Portal</h2>
                <p class="text-pink-100 mt-1">Manage your delicious cake business</p>
            </div>
            <div class="p-8 bg-white">
                <form id="loginForm" class="space-y-6">
                    <div class="relative">
                        <label class="block text-gray-700 mb-2 font-medium" for="username">Username</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <svg class="h-5 w-5 text-pink-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <select id="username" required
                                class="input-field w-full pl-10 pr-4 py-3 rounded-lg focus:outline-none text-base">
                                <option value="">Select Admin</option>
                                <option value="Al Rafi Ahmed">Al Rafi Ahmed</option>
                                <option value="Saymoon Nahar Mariam">Saymoon Nahar Mariam</option>
                                <option value="Yubayer Bin Zakir">Yubayer Bin Zakir</option>
                            </select>
                        </div>
                    </div>
                    <div class="relative">
                        <label class="block text-gray-700 mb-2 font-medium" for="password">Password</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <svg class="h-5 w-5 text-pink-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <input type="password" id="password" required
                                class="input-field w-full pl-10 pr-4 py-3 rounded-lg focus:outline-none text-base">
                            <div id="passwordToggle" class="absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer">
                                <svg id="showPasswordIcon" class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                                    <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd" />
                                </svg>
                                <svg id="hidePasswordIcon" class="h-5 w-5 text-gray-400 hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z" clip-rule="evenodd" />
                                    <path d="M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                    <button type="submit"
                        class="login-btn w-full text-white py-3 rounded-lg text-lg font-medium">
                        Login
                    </button>
                </form>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="hidden">
            <!-- Admin Profile Card -->
            <div class="bg-white rounded-lg shadow-lg p-4 md:p-6 mb-6 admin-profile-card animate__animated animate__fadeInDown">
                <div class="flex flex-col md:flex-row items-center md:items-start gap-6">
                    <div class="order-2 md:order-1 flex-1">
                        <h2 class="text-4xl font-bold text-gray-800 mb-2" id="adminProfileName">Admin Name</h2>
                        <p class="text-2xl text-pink-600 font-medium mb-3" id="adminProfilePosition">Position: Administrator</p>
                        <p class="text-xl text-gray-600 mb-6">Cake Delights Bakery</p>
                        <div class="flex items-center text-gray-600 text-lg">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                            <span>Last login: <span id="lastLoginTime">Today at 9:30 AM</span> (Bangladesh Time)</span>
                        </div>
                    </div>
                    <div class="order-1 md:order-2">
                        <div class="w-48 h-48 md:w-48 md:h-48 overflow-hidden admin-avatar">
                            <img id="adminProfileImage" src="https://via.placeholder.com/128x128.png?text=Admin" alt="Admin Profile" class="w-full h-full object-cover">
                        </div>
                        <div class="absolute bottom-0 right-0 bg-green-500 w-5 h-5 md:w-6 md:h-6 rounded-full border-2 border-white"></div>
                    </div>
                </div>
            </div>

            <!-- Welcome Message -->
            <div id="welcomeMessage" class="bg-white rounded-lg shadow-lg p-4 md:p-6 mb-6 animate__animated animate__fadeInDown">
                <div class="flex flex-col md:flex-row items-center justify-between">
                    <div class="flex items-center mb-4 md:mb-0">
                        <svg class="w-10 h-10 text-pink-500 mr-3" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <div>
                            <h2 class="text-2xl font-bold text-gray-800" id="adminNameDisplay">Welcome!</h2>
                            <p class="text-gray-600">You've successfully logged into your admin portal</p>
                        </div>
                    </div>
                    <button id="dismissWelcome" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 md:mb-8 gap-4">
                <h2 class="text-2xl md:text-3xl font-bold" id="adminPortalTitle">Admin Dashboard</h2>
                <button id="logoutBtn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 w-full md:w-auto">
                    Logout
                </button>
            </div>

            <!-- Add New Cake Form -->
            <div id="addCakeFormContainer" class="bg-white rounded-lg shadow-lg p-4 md:p-8 mb-6 md:mb-8">
                <!-- Edit Mode Indicator -->
                <div id="editModeIndicator" class="edit-indicator hidden">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path>
                    </svg>
                    <span>Edit Mode: Updating existing cake variant</span>
                    <button id="cancelEditBtn" class="cancel-edit-btn ml-auto">Cancel Edit</button>
                </div>
                
                <h3 class="text-xl md:text-2xl font-bold mb-4 md:mb-6" id="formTitle">Add New Cake Variant</h3>
                <form id="addCakeForm" class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                    <div>
                        <label class="block text-gray-700 mb-1 md:mb-2" for="cakeName">Cake Name</label>
                        <input type="text" id="cakeName" required
                            class="w-full px-3 md:px-4 py-2 border rounded-lg focus:outline-none focus:border-pink-500 text-base">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-gray-700 mb-1 md:mb-2" for="cakeDescription">Description</label>
                        <textarea id="cakeDescription" required
                            class="w-full px-3 md:px-4 py-2 border rounded-lg focus:outline-none focus:border-pink-500 text-base" rows="3"></textarea>
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-1 md:mb-2" for="pricePerPound">Price per Pound (BDT)</label>
                        <input type="number" id="pricePerPound" required step="1"
                            class="w-full px-3 md:px-4 py-2 border rounded-lg focus:outline-none focus:border-pink-500 text-base">
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-gray-700 mb-1 md:mb-2" for="cakeImage">Cake Image</label>
                        <input type="file" id="cakeImage" accept="image/*"
                            class="w-full px-3 md:px-4 py-2 border rounded-lg focus:outline-none focus:border-pink-500 text-base">
                        <p class="text-sm text-gray-500 mt-1" id="imageHelpText">Image will be displayed in Featured Cakes and Our Cake Menu</p>
                        
                        <!-- Current Image Preview for Edit Mode -->
                        <div id="currentImagePreview" class="hidden mt-3">
                            <p class="text-sm text-gray-600 mb-2">Current Image:</p>
                            <img id="currentImage" src="" alt="Current cake image" class="w-32 h-32 object-cover rounded-lg border-2 border-gray-200">
                        </div>
                    </div>
                    <div class="md:col-span-2">
                        <button type="submit" id="submitBtn"
                            class="w-full bg-pink-600 text-white py-2 md:py-3 rounded-lg hover:bg-pink-700 transition duration-300 text-base md:text-lg">
                            Add Cake Variant
                        </button>
                    </div>
                </form>
            </div>

            <!-- Dashboard Tabs -->
            <div class="mb-8">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button id="recentOrdersTab" class="tab-button active text-center">
                        <div class="flex flex-col items-center space-y-2">
                            <svg class="w-8 h-8 tab-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd"></path>
                            </svg>
                            <span class="font-semibold text-sm">Recent Orders</span>
                        </div>
                    </button>
                    <button id="orderHistoryTab" class="tab-button text-center">
                        <div class="flex flex-col items-center space-y-2">
                            <svg class="w-8 h-8 tab-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                            </svg>
                            <span class="font-semibold text-sm">Order History</span>
                        </div>
                    </button>
                    <button id="manageCakesTab" class="tab-button text-center">
                        <div class="flex flex-col items-center space-y-2">
                            <svg class="w-8 h-8 tab-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 2a1 1 0 00-1 1v1a1 1 0 002 0V3a1 1 0 00-1-1zM4 4h3a3 3 0 006 0h3a2 2 0 012 2v9a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2zm2.5 7a1.5 1.5 0 100-3 1.5 1.5 0 000 3zm2.45 4a2.5 2.5 0 10-4.9 0h4.9zM12 9a1 1 0 100 2h3a1 1 0 100-2h-3zm-1 4a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z"></path>
                            </svg>
                            <span class="font-semibold text-sm">Manage Cakes</span>
                        </div>
                    </button>
                    <button id="activityLogTab" class="tab-button text-center">
                        <div class="flex flex-col items-center space-y-2">
                            <svg class="w-8 h-8 tab-icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                            </svg>
                            <span class="font-semibold text-sm">Activity Log</span>
                        </div>
                    </button>
                </div>
            </div>

            <!-- Recent Orders Section -->
            <div id="recentOrdersSection" class="section-card section-enter">
                <div class="section-header">
                    <div class="flex items-center space-x-3">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z" clip-rule="evenodd"></path>
                        </svg>
                        <h3 class="text-2xl font-bold">Recent Orders</h3>
                    </div>
                </div>
                <div class="section-content">
                    <div id="ordersList" class="space-y-4">
                        <!-- Orders will be dynamically added here -->
                    </div>
                </div>
            </div>

            <!-- Order History Section -->
            <div id="orderHistorySection" class="section-card hidden">
                <div class="section-header">
                    <div class="flex items-center space-x-3">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                        </svg>
                        <h3 class="text-2xl font-bold">Order History</h3>
                    </div>
                </div>
                <div class="section-content">
                    <div id="ordersHistoryList" class="space-y-4">
                        <!-- Order history will be dynamically added here -->
                    </div>
                </div>
            </div>

            <!-- Manage Cakes Section -->
            <div id="manageCakesSection" class="section-card hidden">
                <div class="section-header">
                    <div class="flex items-center space-x-3">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path d="M10 2a1 1 0 00-1 1v1a1 1 0 002 0V3a1 1 0 00-1-1zM4 4h3a3 3 0 006 0h3a2 2 0 012 2v9a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2zm2.5 7a1.5 1.5 0 100-3 1.5 1.5 0 000 3zm2.45 4a2.5 2.5 0 10-4.9 0h4.9zM12 9a1 1 0 100 2h3a1 1 0 100-2h-3zm-1 4a1 1 0 011-1h2a1 1 0 110 2h-2a1 1 0 01-1-1z"></path>
                        </svg>
                        <h3 class="text-2xl font-bold">Manage Cake Variants</h3>
                    </div>
                </div>
                <div class="section-content">
                    <div id="cakesList" class="space-y-4">
                        <!-- Cakes will be dynamically added here -->
                    </div>
                </div>
            </div>

            <!-- Activity Log Section -->
            <div id="activityLogSection" class="section-card hidden">
                <div class="section-header">
                    <div class="flex items-center space-x-3">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                        </svg>
                        <h3 class="text-2xl font-bold">Admin Activity Log</h3>
                    </div>
                </div>
                <div class="section-content">
                    <div id="activityLogList" class="space-y-4">
                        <!-- Activity logs will be dynamically added here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variable to track edit mode
        let isEditMode = false;
        let editingCakeId = null;

        // Check login status on page load
        function checkLoginStatus() {
            const loggedInUser = localStorage.getItem('loggedInUser');
            if (loggedInUser) {
                const userData = JSON.parse(loggedInUser);
                showDashboard(userData, false); // Pass false to indicate this is not a fresh login
            }
        }

        // Function to show dashboard with user data
        function showDashboard(userData, isNewLogin = true) {
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('adminDashboard').classList.remove('hidden');
            document.getElementById('adminDashboard').classList.add('animate__animated', 'animate__fadeIn');
            
            // Set the admin name in the welcome message and title
            document.getElementById('adminNameDisplay').textContent = `Welcome, ${userData.username}!`;
            document.getElementById('adminPortalTitle').textContent = `${userData.username}'s Portal`;
            
            // Update admin profile card
            document.getElementById('adminProfileName').textContent = userData.username;
            document.getElementById('adminProfilePosition').textContent = `Position: ${userData.position}`;
            document.getElementById('adminProfileImage').src = userData.image;
            document.getElementById('lastLoginTime').textContent = userData.lastLogin || new Date().toLocaleString('en-US', { timeZone: 'Asia/Dhaka', hour12: true });
            
            // Only show welcome message for fresh logins, not on page reload
            if (isNewLogin) {
                // Show welcome message with animation
                const welcomeMessage = document.getElementById('welcomeMessage');
                welcomeMessage.classList.remove('hidden');
                welcomeMessage.classList.add('animate__animated', 'animate__fadeInDown');
                
                // Auto-hide welcome message after 2 seconds
                setTimeout(() => {
                    welcomeMessage.classList.add('animate__fadeOutUp');
                    setTimeout(() => {
                        welcomeMessage.classList.add('hidden');
                    }, 500);
                }, 2000);
            } else {
                // Hide welcome message on page reload
                document.getElementById('welcomeMessage').classList.add('hidden');
            }
            
            loadOrders();
            loadOrderHistory();
            loadCakes();
        }

        // Function to show success popup
        function showSuccessPopup(cakeData) {
            // Populate popup with cake data
            document.getElementById('popupCakeImage').src = cakeData.image;
            document.getElementById('popupCakeName').textContent = cakeData.name;
            document.getElementById('popupCakeDescription').textContent = cakeData.description;
            document.getElementById('popupCakePrice').textContent = cakeData.pricePerPound + ' BDT';
            document.getElementById('popupDateAdded').textContent = new Date(cakeData.dateAdded).toLocaleString();
            
            // Show popup
            const popup = document.getElementById('successPopup');
            popup.classList.remove('hidden');
            
            // Auto-hide popup after 2 seconds
            setTimeout(() => {
                popup.classList.add('animate__fadeOut');
                setTimeout(() => {
                    popup.classList.add('hidden');
                    popup.classList.remove('animate__fadeOut');
                }, 500);
            }, 2000);
        }

        // Function to enter edit mode
        function enterEditMode(cake) {
            isEditMode = true;
            editingCakeId = cake.id;
            
            // Update form container styling
            const formContainer = document.getElementById('addCakeFormContainer');
            formContainer.classList.add('edit-mode');
            
            // Show edit mode indicator
            const editIndicator = document.getElementById('editModeIndicator');
            editIndicator.classList.remove('hidden');
            
            // Update form title and button
            document.getElementById('formTitle').textContent = 'Edit Cake Variant';
            document.getElementById('submitBtn').textContent = 'Update Cake Variant';
            
            // Populate form with existing data
            document.getElementById('cakeName').value = cake.name;
            document.getElementById('cakeDescription').value = cake.description;
            document.getElementById('pricePerPound').value = cake.pricePerPound;
            
            // Show current image preview
            const currentImagePreview = document.getElementById('currentImagePreview');
            const currentImage = document.getElementById('currentImage');
            currentImage.src = cake.image;
            currentImagePreview.classList.remove('hidden');
            
            // Update image field to not be required and update help text
            const imageField = document.getElementById('cakeImage');
            imageField.removeAttribute('required');
            document.getElementById('imageHelpText').textContent = 'Leave empty to keep current image, or select a new image to replace it';
            
            // Scroll to form
            formContainer.scrollIntoView({ behavior: 'smooth' });
        }

        // Function to exit edit mode
        function exitEditMode() {
            isEditMode = false;
            editingCakeId = null;
            
            // Reset form container styling
            const formContainer = document.getElementById('addCakeFormContainer');
            formContainer.classList.remove('edit-mode');
            
            // Hide edit mode indicator
            const editIndicator = document.getElementById('editModeIndicator');
            editIndicator.classList.add('hidden');
            
            // Reset form title and button
            document.getElementById('formTitle').textContent = 'Add New Cake Variant';
            document.getElementById('submitBtn').textContent = 'Add Cake Variant';
            
            // Hide current image preview
            const currentImagePreview = document.getElementById('currentImagePreview');
            currentImagePreview.classList.add('hidden');
            
            // Reset image field to be required and reset help text
            const imageField = document.getElementById('cakeImage');
            imageField.setAttribute('required', 'required');
            document.getElementById('imageHelpText').textContent = 'Image will be displayed in Featured Cakes and Our Cake Menu';
            
            // Clear form
            document.getElementById('addCakeForm').reset();
        }

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');

        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Password toggle visibility
        const passwordToggle = document.getElementById('passwordToggle');
        const passwordField = document.getElementById('password');
        const showPasswordIcon = document.getElementById('showPasswordIcon');
        const hidePasswordIcon = document.getElementById('hidePasswordIcon');

        passwordToggle.addEventListener('click', () => {
            if (passwordField.type === 'password') {
                passwordField.type = 'text';
                showPasswordIcon.classList.add('hidden');
                hidePasswordIcon.classList.remove('hidden');
            } else {
                passwordField.type = 'password';
                showPasswordIcon.classList.remove('hidden');
                hidePasswordIcon.classList.add('hidden');
            }
        });

        // Admin credentials (in a real application, this would be handled server-side)
        const ADMIN_CREDENTIALS = [
            {
                username: 'Al Rafi Ahmed',
                password: '1234',
                position: 'Operational Administrator',
                image: 'Al RAfi.jpg'
            },
            {
                username: 'Saymoon Nahar Mariam',
                password: 'Saymoon2004',
                position: 'Managing Director',
                image: 'https://randomuser.me/api/portraits/women/44.jpg'
            },
            {
                username: 'Yubayer Bin Zakir',
                password: '1234',
                position: 'উচ্চপদস্থ কর্মকর্তা',
                image: 'Yubayer.jpg'
            }
        ];

        // Welcome message dismiss button
        document.getElementById('dismissWelcome').addEventListener('click', function() {
            document.getElementById('welcomeMessage').classList.add('animate__fadeOutUp');
            setTimeout(() => {
                document.getElementById('welcomeMessage').classList.add('hidden');
            }, 500);
        });

        // Cancel edit button
        document.getElementById('cancelEditBtn').addEventListener('click', function() {
            exitEditMode();
        });

        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const validAdmin = ADMIN_CREDENTIALS.find(admin => 
                admin.username === username && admin.password === password
            );

            if (validAdmin) {
                document.getElementById('loginSection').classList.add('animate__animated', 'animate__fadeOutUp');
                
                // Save login state to localStorage
                const userData = {
                    username: validAdmin.username,
                    position: validAdmin.position,
                    image: validAdmin.image,
                    lastLogin: new Date().toLocaleString('en-US', { timeZone: 'Asia/Dhaka', hour12: true })
                };
                localStorage.setItem('loggedInUser', JSON.stringify(userData));
                
                setTimeout(() => {
                    showDashboard(userData, true); // Pass true to indicate this is a fresh login
                }, 500);
            } else {
                document.getElementById('loginSection').classList.add('animate__animated', 'animate__shakeX');
                setTimeout(() => {
                    document.getElementById('loginSection').classList.remove('animate__shakeX');
                }, 500);
                alert('Invalid credentials!');
            }
        });

        // Logout handler
        document.getElementById('logoutBtn').addEventListener('click', function() {
            // Remove the logged in user from localStorage
            localStorage.removeItem('loggedInUser');
            
            // Exit edit mode if active
            if (isEditMode) {
                exitEditMode();
            }
            
            document.getElementById('adminDashboard').classList.add('animate__animated', 'animate__fadeOutDown');
            setTimeout(() => {
                document.getElementById('adminDashboard').classList.add('hidden');
                document.getElementById('loginSection').classList.remove('hidden', 'animate__fadeOutUp');
                document.getElementById('loginSection').classList.add('animate__fadeIn');
                document.getElementById('loginForm').reset();
                document.getElementById('adminDashboard').classList.remove('animate__fadeOutDown');
            }, 500);
        });

        // Tab switching function
        function switchTab(activeTabId, activeSectionId) {
            // Exit edit mode when switching tabs
            if (isEditMode) {
                exitEditMode();
            }
            
            // Hide all sections
            const sections = ['recentOrdersSection', 'orderHistorySection', 'manageCakesSection', 'activityLogSection'];
            sections.forEach(sectionId => {
                document.getElementById(sectionId).classList.add('hidden');
            });
            
            // Remove active class from all tabs
            const tabs = ['recentOrdersTab', 'orderHistoryTab', 'manageCakesTab', 'activityLogTab'];
            tabs.forEach(tabId => {
                document.getElementById(tabId).classList.remove('active');
            });
            
            // Show active section with animation
            const activeSection = document.getElementById(activeSectionId);
            activeSection.classList.remove('hidden');
            activeSection.classList.add('section-enter');
            
            // Add active class to clicked tab
            document.getElementById(activeTabId).classList.add('active');
            
            // Remove animation class after animation completes
            setTimeout(() => {
                activeSection.classList.remove('section-enter');
            }, 500);
        }

        // Tab event listeners
        document.getElementById('recentOrdersTab').addEventListener('click', function() {
            switchTab('recentOrdersTab', 'recentOrdersSection');
            loadOrders();
        });

        document.getElementById('orderHistoryTab').addEventListener('click', function() {
            switchTab('orderHistoryTab', 'orderHistorySection');
            loadOrderHistory();
        });

        document.getElementById('manageCakesTab').addEventListener('click', function() {
            switchTab('manageCakesTab', 'manageCakesSection');
            loadCakes();
        });

        document.getElementById('activityLogTab').addEventListener('click', function() {
            switchTab('activityLogTab', 'activityLogSection');
            loadActivityLog();
        });

        // Add new cake form handler
        document.getElementById('addCakeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (isEditMode) {
                // Handle update
                handleCakeUpdate();
            } else {
                // Handle new cake creation
                handleNewCake();
            }
        });

        // Load and display cakes for management
        function loadCakes() {
            const cakesList = document.getElementById('cakesList');
            const cakes = JSON.parse(localStorage.getItem('cakeVariants') || '[]');
            
            // Sort cakes by date added (most recent first)
            cakes.sort((a, b) => {
                const dateA = new Date(a.dateAdded || 0).getTime();
                const dateB = new Date(b.dateAdded || 0).getTime();
                return dateB - dateA;
            });

            cakesList.innerHTML = cakes.length === 0 ? 
                '<p class="text-gray-500 text-center py-4">No cakes added yet</p>' : 
                cakes.map(cake => `
                <div class="order-card bg-gray-50 p-4 md:p-6 rounded-lg border">
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="w-full md:w-1/4">
                            <img src="${cake.image}" alt="${cake.name}" class="w-full h-48 object-cover rounded-lg">
                        </div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h4 class="text-lg font-semibold">${cake.name}</h4>
                                    <p class="text-gray-600 mt-1">${cake.description}</p>
                                </div>
                                <div class="text-right">
                                    <p class="text-lg font-bold text-pink-600">${cake.pricePerPound} BDT</p>
                                    <p class="text-sm text-gray-500">per pound</p>
                                </div>
                            </div>
                            <div class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-white p-3 rounded-lg border">
                                    <p class="text-sm text-gray-500">Added on</p>
                                    <p class="font-medium">${new Date(cake.dateAdded).toLocaleString()}</p>
                                </div>
                                <div class="bg-white p-3 rounded-lg border">
                                    <p class="text-sm text-gray-500">Last Updated</p>
                                    <p class="font-medium">${cake.lastUpdated ? new Date(cake.lastUpdated).toLocaleString() : 'Never'}</p>
                                </div>
                            </div>
                            <div class="mt-4 flex flex-wrap gap-2">
                                <button onclick="editCake(${cake.id})"
                                    class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition duration-300 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                    </svg>
                                    Edit
                                </button>
                                <button onclick="deleteCake(${cake.id})"
                                    class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition duration-300 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                    Delete
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Function to handle cake update
        function handleCakeUpdate() {
            const cakes = JSON.parse(localStorage.getItem('cakeVariants') || '[]');
            const cakeIndex = cakes.findIndex(c => c.id === editingCakeId);
            
            if (cakeIndex === -1) {
                alert('Cake not found!');
                return;
            }

            const updatedCake = {
                ...cakes[cakeIndex],
                name: document.getElementById('cakeName').value,
                description: document.getElementById('cakeDescription').value,
                pricePerPound: document.getElementById('pricePerPound').value,
                lastUpdated: new Date().toISOString()
            };

            const cakeImageFile = document.getElementById('cakeImage').files[0];
            
            if (cakeImageFile) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    updatedCake.image = event.target.result;
                    cakes[cakeIndex] = updatedCake;
                    localStorage.setItem('cakeVariants', JSON.stringify(cakes));
                    
                    logActivity('updated', `Updated cake variant: ${updatedCake.name} (Price: ${updatedCake.pricePerPound} BDT per pound)`);
                    
                    alert('Cake variant updated successfully!');
                    exitEditMode();
                    loadCakes();
                };
                reader.readAsDataURL(cakeImageFile);
            } else {
                cakes[cakeIndex] = updatedCake;
                localStorage.setItem('cakeVariants', JSON.stringify(cakes));
                
                logActivity('updated', `Updated cake variant: ${updatedCake.name} (Price: ${updatedCake.pricePerPound} BDT per pound)`);
                
                alert('Cake variant updated successfully!');
                exitEditMode();
                loadCakes();
            }
        }

        // Function to handle new cake creation
        function handleNewCake() {
            const cakeImageFile = document.getElementById('cakeImage').files[0];
            if (!cakeImageFile) {
                alert('Please select an image for the cake');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const imageBase64 = event.target.result;
                
                const newCake = {
                    id: Date.now(),
                    name: document.getElementById('cakeName').value,
                    description: document.getElementById('cakeDescription').value,
                    pricePerPound: document.getElementById('pricePerPound').value,
                    image: imageBase64,
                    dateAdded: new Date().toISOString(),
                    lastUpdated: new Date().toISOString()
                };

                const cakes = JSON.parse(localStorage.getItem('cakeVariants') || '[]');
                cakes.push(newCake);
                localStorage.setItem('cakeVariants', JSON.stringify(cakes));

                // Log the activity
                logActivity('created', `Added new cake variant: ${newCake.name} (Price: ${newCake.pricePerPound} BDT per pound)`);

                // Show success popup with cake data
                showSuccessPopup(newCake);

                loadCakes();
                document.getElementById('addCakeForm').reset();
            };
            reader.readAsDataURL(cakeImageFile);
        }

        // Load and display orders
        function loadOrders() {
            const ordersList = document.getElementById('ordersList');
            const orders = JSON.parse(localStorage.getItem('cakeOrders') || '[]');
            const pendingOrders = orders.filter(order => order.status === 'pending');

            ordersList.innerHTML = pendingOrders.length === 0 ? 
                '<p class="text-gray-500 text-center py-4">No pending orders</p>' : 
                pendingOrders.map(order => `
                <div class="order-card bg-gray-50 p-4 md:p-6 rounded-lg border">
                    <div class="flex flex-col md:flex-row justify-between items-start gap-4">
                        <div class="flex-1">
                            <h4 class="text-lg font-semibold">${order.name}</h4>
                            <p class="text-gray-600">Phone: ${order.phone}</p>
                            <p class="text-gray-600">Address: ${order.address}</p>
                            <p class="text-gray-600">Cake: ${order.flavor} - ${order.pounds} Pounds</p>
                            <p class="text-gray-600">Quantity: ${order.quantity || 1} ${order.quantity > 1 ? 'cakes' : 'cake'}</p>
                            <p class="text-gray-600">Total Price: ${order.totalPrice ? order.totalPrice + ' BDT' : 'N/A'}</p>
                            ${order.message ? `<p class="text-gray-600">Message: ${order.message}</p>` : ''}
                            <p class="text-sm text-gray-500">Ordered on: ${new Date(order.date).toLocaleString()}</p>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2 w-full md:w-auto">
                            <button onclick="updateOrderStatus(${order.id}, 'accepted')"
                                class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 w-full sm:w-auto">
                                Accept
                            </button>
                            <button onclick="updateOrderStatus(${order.id}, 'cancelled')"
                                class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 w-full sm:w-auto">
                                Cancel
                            </button>
                        </div>
                    </div>
                    <div class="mt-2">
                        <span class="px-3 py-1 rounded-full text-sm ${
                            order.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :
                            order.status === 'accepted' ? 'bg-green-100 text-green-800' :
                            'bg-red-100 text-red-800'
                        }">
                            ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                        </span>
                    </div>
                </div>
            `).join('');
        }

        // Load and display order history
        function loadOrderHistory() {
            const ordersHistoryList = document.getElementById('ordersHistoryList');
            const orders = JSON.parse(localStorage.getItem('cakeOrders') || '[]');
            const historyOrders = orders.filter(order => order.status === 'accepted' || order.status === 'cancelled');
            
            // Sort history orders by statusUpdateTime in descending order (most recent first)
            historyOrders.sort((a, b) => {
                const timeA = new Date(a.statusUpdateTime || a.date).getTime();
                const timeB = new Date(b.statusUpdateTime || b.date).getTime();
                return timeB - timeA;
            });

            ordersHistoryList.innerHTML = historyOrders.length === 0 ? 
                '<p class="text-gray-500 text-center py-4">No order history</p>' : 
                historyOrders.map(order => `
                <div class="order-card bg-gray-50 p-4 md:p-6 rounded-lg border">
                    <div class="flex flex-col md:flex-row justify-between items-start gap-4">
                        <div class="flex-1">
                            <h4 class="text-lg font-semibold">${order.name}</h4>
                            <p class="text-gray-600">Phone: ${order.phone}</p>
                            <p class="text-gray-600">Address: ${order.address}</p>
                            <p class="text-gray-600">Cake: ${order.flavor} - ${order.pounds} Pounds</p>
                            <p class="text-gray-600">Quantity: ${order.quantity || 1} ${order.quantity > 1 ? 'cakes' : 'cake'}</p>
                            <p class="text-gray-600">Total Price: ${order.totalPrice ? order.totalPrice + ' BDT' : 'N/A'}</p>
                            ${order.message ? `<p class="text-gray-600">Message: ${order.message}</p>` : ''}
                            <p class="text-sm text-gray-500">Ordered on: ${new Date(order.date).toLocaleString()}</p>
                            ${order.statusUpdateTime ? 
                                `<p class="text-sm text-gray-500">${order.status === 'accepted' ? 'Accepted' : 'Cancelled'} on: ${new Date(order.statusUpdateTime).toLocaleString()}</p>` : ''}
                        </div>
                    </div>
                    <div class="mt-2">
                        <span class="px-3 py-1 rounded-full text-sm ${
                            order.status === 'accepted' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
                        }">
                            ${order.status.charAt(0).toUpperCase() + order.status.slice(1)}
                        </span>
                    </div>
                </div>
            `).join('');
        }

        // Update order status
        function updateOrderStatus(orderId, newStatus) {
            const orders = JSON.parse(localStorage.getItem('cakeOrders') || '[]');
            const orderIndex = orders.findIndex(order => order.id === orderId);
            
            if (orderIndex !== -1) {
                const order = orders[orderIndex];
                orders[orderIndex].status = newStatus;
                orders[orderIndex].statusUpdateTime = new Date().toISOString();
                localStorage.setItem('cakeOrders', JSON.stringify(orders));
                
                // Log the activity with more details
                const orderDetails = `Order #${orderId} for ${order.name} (${order.flavor} - ${order.pounds} pounds, Qty: ${order.quantity || 1}, Total: ${order.totalPrice ? order.totalPrice + ' BDT' : 'N/A'})`;
                logActivity(newStatus, orderDetails);
                
                loadOrders();
                loadOrderHistory();
            }
        }

        // Delete cake function
        function deleteCake(cakeId) {
            if (confirm('Are you sure you want to delete this cake variant?')) {
                const cakes = JSON.parse(localStorage.getItem('cakeVariants') || '[]');
                const cakeToDelete = cakes.find(cake => cake.id === cakeId);
                const updatedCakes = cakes.filter(cake => cake.id !== cakeId);
                localStorage.setItem('cakeVariants', JSON.stringify(updatedCakes));
                
                // Log the activity
                if (cakeToDelete) {
                    logActivity('deleted', `Deleted cake variant: ${cakeToDelete.name} (Price: ${cakeToDelete.pricePerPound} BDT per pound)`);
                }
                
                alert('Cake variant deleted successfully!');
                loadCakes();
            }
        }

        // Edit cake function
        function editCake(cakeId) {
            const cakes = JSON.parse(localStorage.getItem('cakeVariants') || '[]');
            const cake = cakes.find(c => c.id === cakeId);
            
            if (cake) {
                enterEditMode(cake);
            }
        }

        // Add this function to log activities
        function logActivity(action, details) {
            const activities = JSON.parse(localStorage.getItem('adminActivities') || '[]');
            const currentUser = JSON.parse(localStorage.getItem('loggedInUser'));
            
            const activity = {
                id: Date.now(),
                admin: currentUser.username,
                action: action,
                details: details,
                timestamp: new Date().toISOString()
            };
            
            activities.unshift(activity); // Add to beginning of array
            localStorage.setItem('adminActivities', JSON.stringify(activities));
            loadActivityLog();
        }

        // Add this function to load and display activity logs
        function loadActivityLog() {
            const activityLogList = document.getElementById('activityLogList');
            const activities = JSON.parse(localStorage.getItem('adminActivities') || '[]');

            activityLogList.innerHTML = activities.length === 0 ? 
                '<p class="text-gray-500 text-center py-4">No activities logged yet</p>' : 
                activities.map(activity => `
                <div class="order-card bg-gray-50 p-4 md:p-6 rounded-lg border">
                    <div class="flex flex-col md:flex-row justify-between items-start gap-4">
                        <div class="flex-1">
                            <div class="flex items-center gap-2">
                                <span class="px-3 py-1 rounded-full text-sm ${
                                    activity.action === 'created' ? 'bg-blue-100 text-blue-800' :
                                    activity.action === 'accepted' ? 'bg-green-100 text-green-800' :
                                    activity.action === 'cancelled' ? 'bg-red-100 text-red-800' :
                                    activity.action === 'updated' ? 'bg-yellow-100 text-yellow-800' :
                                    activity.action === 'deleted' ? 'bg-red-100 text-red-800' :
                                    'bg-gray-100 text-gray-800'
                                }">
                                    ${activity.action.charAt(0).toUpperCase() + activity.action.slice(1)}
                                </span>
                                <span class="text-gray-600">by ${activity.admin}</span>
                            </div>
                            <p class="text-gray-600 mt-2">${activity.details}</p>
                            <p class="text-sm text-gray-500 mt-2">${new Date(activity.timestamp).toLocaleString()}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
        });
    </script>
</body>
</html>